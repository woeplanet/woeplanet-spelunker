{%- extends "base.html.j2" %}
{%- block title %}{{ title }}{%- endblock %}
{%- block content %}
<div class="row h-100">
	<div id="content" class="col-sm-9 h-100">
		<div class="row place-entry">
			<div class="col-sm-4 place-label label-basic">
				Name<br/>
				<span class="slug">in {{ lang }}</span>
			</div>
			<div class="col-sm-8 place-info">
				<span id="woe-name">{{ name }}</span>
			</div>
		</div>
		<div class="row place-entry">
			<div class="col-sm-4 place-label label-basic">
				WOEID
			</div>
			<div class="col-sm-8 place-info">
			{%- if doc['superseded_by'] %}
				<a href="{{ url_for('place_endpoint', woeid=doc['woe_id']) }}" woeid="woe-id-superceded">{{ doc['woe_id'] }}</a>
				<span class="label">
					<div class="slug"><a class="label-superseded" href="{{ url_for('place_endpoint', woeid=doc['superseded_by']) }}">this place has been superseded by WOE ID {{ doc['superseded_by'] }}</a></div>
				</span>
			{%- else %}
					<a href="{{ url_for('place_endpoint', woeid=doc['woe_id']) }}" woeid="woe-id">{{ doc['woe_id'] }}</a>
			{%- endif %}
			</div>
		</div>
		{%- if doc['supersedes'] %}
		<div class="row place-entry">
			<div class="col-sm-4 place-label label-supercedes">Supersedes</div>
			<div class="col-sm-8 place-info">
				<ul>
				{%- for supercedes in doc['supersedes'] %}
					<li><a href="{{ url_for('place_endpoint', woeid=supercedes) }}" woeid="woe-id-superceded">{{ supercedes }}</a></li>
				{%- endfor %}
				<ul>
			</div>
		</div>
		{%- endif %}
		<div class="row place-entry">
			<div class="col-sm-4 place-label label-basic">Place Type</div>
			<div class="col-sm-8 place-info">
				<span id="woe-placetype">{{ placetype.name }}</span>
			</div>
		</div>
		{%- if doc['country'] %}
		<div class="row place-entry">
			<div class="col-sm-4 place-label label-basic">Country</div>
			<div class="col-sm-8 place-info">
				<span class="woe-iso">
					<a href="{{ url_for('country_endpoint', iso=doc['ountry']) }}">{{doc['country']}}</a>
					<div class="slug"><a href="{{ url_for('country_endpoint', iso=doc['country']) }}" class="click-here">click here to see all the places that are part of this country</a></div>
				</span>
			</div>
		</div>
		{%- endif %}
		{%- if doc['hierarchy'] %}
		<div class="row place-entry">
			<div class="col-sm-4 place-label label-basic">Hierarchy</div>
			<div class="col-sm-8 place-info">
				{%- set hierarchy = doc['hierarchy'] %}
				<ul id="woe-hierarchy">
					{%- if hierarchy.planet %}
					<li><a href="{{ url_for('place_endpoint', woeid=hierarchy.planet['woe_id']) }}"><span class="woe-ancestor" woeid="woe-supername">{{ hierarchy.planet['name'] }}</span></a></li>
					{%- endif %}
					{%- if hierarchy.continent and hierarchy.continent['woe_id'] %}
					<li><a href="{{ url_for('place_endpoint', woeid=hierarchy.continent['woe_id']) }}"><span class="woe-ancestor" woeid="woe-supername">{{ hierarchy.continent['name'] }}</span></a></li>
					{%- endif %}
					{%- if hierarchy.region and hierarchy.region['woe_id'] %}
					<li><a href="{{ url_for('place_endpoint', woeid=hierarchy.region['woe_id']) }}"><span class="woe-ancestor" woeid="woe-supername">{{ hierarchy.region['name'] }}</span></a></li>
					{%- endif %}
					{%- if hierarchy.country and hierarchy.country['woe_id'] %}
					<li><a href="{{ url_for('place_endpoint', woeid=hierarchy.country['woe_id']) }}"><span class="woe-ancestor" woeid="woe-supername">{{ hierarchy.country['name'] }}</span></a></li>
					{%- endif %}
					{%- if hierarchy.state and hierarchy.state['woe_id'] %}
					<li><a href="{{ url_for('place_endpoint', woeid=hierarchy.state['woe_id']) }}"><span class="woe-ancestor" woeid="woe-supername">{{ hierarchy.state['name'] }}</span></a></li>
					{%- endif %}
					{%- if hierarchy.county and hierarchy.county['woe_id'] %}
					<li><a href="{{ url_for('place_endpoint', woeid=hierarchy.county['woe_id']) }}"><span class="woe-ancestor" woeid="woe-supername">{{ hierarchy.county['name'] }}</span></a></li>
					{%- endif %}
					{%- if hierarchy.localadmin and hierarchy.localadmin['woe_id'] %}
					<li><a href="{{ url_for('place_endpoint', woeid=hierarchy.localadmin['woe_id']) }}"><span class="woe-ancestor" woeid="woe-supername">{{ hierarchy.localadmin['name'] }}</span></a></li>
					{%- endif %}
					{%- if hierarchy.town and hierarchy.town['woe_id'] %}
					<li><a href="{{ url_for('place_endpoint', woeid=hierarchy.town['woe_id']) }}"><span class="woe-ancestor" woeid="woe-supername">{{ hierarchy.town['name'] }}</span></a></li>
					{%- endif %}
					{%- if hierarchy.suburb and hierarchy.suburb['woe_id'] %}
					<li><a href="{{ url_for('place_endpoint', woeid=hierarchy.suburb['woe_id']) }}"><span class="woe-ancestor" woeid="woe-supername">{{ hierarchy.suburb['name'] }}</span></a></li>
					{%- endif %}
				</ul>
			</div>
		</div>
		{%- endif %}
		{%- if centroid and centroid[0] != 0.0 and centroid[1] != 0.0 %}
		<div class="row place-entry">
			<div class="col-sm-4 place-label label-basic">
				Centroid
				<div class="slug">longitude,latitude</div>
			</div>
			<div class="col-sm-8 place-info">
				<a href="{{ url_for('place_nearby_endpoint', woeid=doc['woe_id']) }}"><span woeid="woe-centroid">{{centroid[1]}}, {{centroid[0]}}</span></a>
				<div class="slug"><a href="{{ url_for('place_nearby_endpoint', woeid=doc['woe_id']) }}" class="click-here">click here to see other nearby places</a></div>
			</div>
		</div>
		{%- endif %}
		{%- if bounds %}
		<div class="row place-entry">
			<div class="col-sm-4 place-label label-basic">
				Bounding Box<div class="slug">southwest, northeast</div>
			</div>
			<div class="col-sm-8 place-info">
				<div woeid="woe-bbox">
					<a href="{{ url_for('place_map_endpoint', woeid=doc['woe_id']) }}">{{bounds[0][1]}}, {{bounds[0][0]}}<br/>{{bounds[1][1]}}, {{bounds[1][0]}}</a>
				</div>
				<div class="slug"><a href="{{ url_for('place_map_endpoint', woeid=doc['woe_id']) }}" class="click-here">click here to see this place on a map</a></div>
			</div>
		</div>
		{%- endif %}
		{%- if doc['children'] %}
		{%- for key,values in doc['children'].items() %}
		{%- set sorted_values = values | unicode_sort(attribute='name') %}
		<div class="row place-entry">
			<div class="col-sm-4 place-label label-children">
				{{ key | lower | pluralise | capitalize }}<div class="slug">that are parented by {{ name }}</div>
			</div>
			<div class="col-sm-8 place-info">
				<ul class="children">
				{%- for place in sorted_values[:30] %}
					<li><a href="{{ url_for('place_endpoint', woeid=place['woe_id']) }}"><span class="woe-child-name">{{place['name']}}</span></a></li>
				{%- endfor %}
				</ul>
				{%- if sorted_values | length > 30 %}
				<details class="mt-2 expandable-list">
					<summary class="btn btn-sm btn-outline-secondary">
						<span class="show-more">Show {{ sorted_values | length - 30 }} more {{ key | lower | pluralise }}</span>
						<span class="show-less">Show less</span>
					</summary>
					<ul class="children mt-2">
					{%- for place in sorted_values[30:] %}
						<li><a href="{{ url_for('place_endpoint', woeid=place['woe_id']) }}"><span class="woe-child-name">{{place['name']}}</span></a></li>
					{%- endfor %}
					</ul>
				</details>
				{%- endif %}
			</div>
		</div>
		{%- endfor %}
		{%- endif %}
		{%- if doc['neighbours'] %}
		{%- for key,values in doc['neighbours'] | dictsort %}
		<div class="row place-entry">
			<div class="col-sm-4 place-label label-adjacencies">
				{{ key | lower | pluralise | capitalize }}<div class="slug">that are next to {{ name }}</div>
			</div>
			<div class="col-sm-8 place-info">
				<ul class="adjacencies">
				{%- for place in values | sort(attribute='name') %}
					<li><a href="{{ url_for('place_endpoint', woeid=place['woe_id']) }}"><span class="woe-adjacent-name">{{place['name']}}</span></a></li>
				{%- endfor %}
				</ul>
			</div>
		</div>
		{%- endfor %}
		{%- endif %}
		{%- if doc['aliases'] %}
		{%- for lang, aliases in doc['aliases'] | dictsort %}
		<div class="row place-entry" data-lang="{{ lang }}">
			<div class="col-sm-4 place-label label-aliases">
				{{ lang | langname }}<div class="slug">aliases for {{name}}</div>
			</div>
			<div class="col-sm-8 place-info">
				<ul class="list_aliases">
                {%- for name_type, entry in aliases | dictsort %}
                    {%- for name in entry %}
					<li><a href="/search/{{name}}"><span class="woe-alias">{{name}}</span></a></li>
                    {%- endfor %}
                {%- endfor %}

                {#
				{%- for name in alias.aliases %}
					<li><a href="/search/{{name}}"><span class="woe-alias">{{name}}</span></a></li>
				{%- endfor %}
                #}
				</ul>
			</div>
		</div>
		{%- endfor %}
		{%- endif %}

        {%- if doc['licenses'] %}
        <div class="row place-entry">
            <div class="col-sm-4 place-label label-source">Licenses</div>
            <div class="col-sm-8 place-info">
                <ul id="woe-licenses">
                {%- for license in doc['licenses'] %}
                    <li><a href="{{ url_for('licenses_endpoint') }}#{{ license }}"><span class="woe-license">{{ license }}</span></a></li>
                {%- endfor %}
                </ul>
            </div>
        </div>
        {%- endif %}

        {%- if doc['history'] %}
        <div class="row place-entry">
            <div class="col-sm-4 place-label label-source">History</div>
            <div class="col-sm-8 place-info">
                <ul id="woe-licenses">
                {%- for key,value in doc['history'].items() %}
                    <li><span id="woe-license">{{ key }}</span></li>
                {%- endfor %}
                </ul>
            </div>
        </div>
        {%- endif %}

		{%- if doc['meta:provider'] %}
		<div class="row place-entry">
			<div class="col-sm-4 place-label label-source">Source</div>
			<div class="col-sm-8 place-info">
				<ul id="woe-providers">
				{%- for provider in doc['meta:provider'] %}
					<li><span id="woe-provider">{{ provider}}</span></li>
				{%- endfor %}
				<ul>
			</div>
		</div>
		{%- endif %}
		{%- if doc['meta:indexed'] %}
		<div class="row place-entry">
			<div class="col-sm-4 place-label label-source">Indexed</div>
			<div class="col-sm-8 place-info">
				<span id="woe-date-indexed">{{ doc['meta:indexed'] }}</span>
			</div>
		</div>
		{%- endif %}
		{%- if urls %}
		<div class="row place-entry">
			<div class="col-sm-4 place-label label-source">Repository</div>
			<div class="col-sm-8 place-info">
				<span id="woe-date-indexed"><a href="{{ urls['repo'] }}" target="_blank">{{ doc['repo'] }}</a></span>
			</div>
		</div>
		<div class="row place-entry">
			<div class="col-sm-4 place-label label-source">GeoJSON</div>
			<div class="col-sm-8 place-info">
				<span id="woe-date-indexed"><a href="{{ urls['geojson'] }}" target="_blank">{{ urls['source'] }}</a></span>
			</div>
		</div>
		{%- endif %}
		{%- include "includes/footer.html.j2" %}
	</div>
	{%- include "includes/sidebar.html.j2" %}
</div>
{%- endblock %}
